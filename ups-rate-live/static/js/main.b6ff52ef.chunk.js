(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{10:function(e,t,a){e.exports=a(20)},15:function(e,t,a){},17:function(e,t,a){},20:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),i=a(3),r=a.n(i),l=(a(15),a(7)),c=a(4),o=a(5),u=a(8),d=a(6),m=a(9),h=a(1),p=(a(17),function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(u.a)(this,Object(d.a)(t).call(this))).state={fetchLimit:2,fetchCount:0,maxAge:2,subreddit:"politics",listings:[],posts:[],allTitles:[],displayTitles:"loading...",interval:6e4,pollRef:null},e.reqData=e.reqData.bind(Object(h.a)(Object(h.a)(e))),e.handleRes=e.handleRes.bind(Object(h.a)(Object(h.a)(e))),e.parseListings=e.parseListings.bind(Object(h.a)(Object(h.a)(e))),e.getListItems=e.getListItems.bind(Object(h.a)(Object(h.a)(e))),e.sortListItems=e.sortListItems.bind(Object(h.a)(Object(h.a)(e))),e.filterListItems=e.filterListItems.bind(Object(h.a)(Object(h.a)(e))),e.handleSubmit=e.handleSubmit.bind(Object(h.a)(Object(h.a)(e))),e.componentDidMount=e.componentDidMount.bind(Object(h.a)(Object(h.a)(e))),e}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.reqData(),this.setState(function(t,a){return{pollRef:setInterval(function(){return e.reqData()},e.state.interval)}})}},{key:"reqData",value:function(e){var t,a,n=this;t=e||"https://old.reddit.com/r/".concat(this.state.subreddit,".json?limit=100"),a=new Request(t),fetch(a).then(function(e){return e.json()},function(e){console.log("fetch rejected:\n",e.toString()),n.setState(function(e,t){return{displayTitles:"error: invalid subreddit, fetch rejected by browser, or reddit is down."}})}).then(function(e){e?n.handleRes(e):console.log("falsy response:\n",e)}).catch(function(e){return console.log("fetch error:\n",e)})}},{key:"handleRes",value:function(e){var t=this;e.error?this.setState(function(t,a){return{displayTitles:"".concat(e.error,": ").concat(e.message)}}):this.setState(function(t,a){return{fetchCount:t.fetchCount+1,listings:Object(l.a)(t.listings).concat([e])}},function(){t.state.fetchCount<t.state.fetchLimit&&t.state.listings[+t.state.fetchCount-1].data.after?t.reqData("https://old.reddit.com/r/".concat(t.state.subreddit,".json?limit=100&after=").concat(t.state.listings[t.state.fetchCount-1].data.after)):t.setState(function(e,t){return{fetchCount:0}},function(){return t.parseListings()})})}},{key:"parseListings",value:function(){var e=this,t=this.state.posts,a=[];Object.values(this.state.listings).forEach(function(n){Object.values(n.data.children).forEach(function(n){Object.keys(e.state.posts).includes(n.data.id)?t[n.data.id].ups!==n.data.ups&&(t[n.data.id].ups=n.data.ups,t[n.data.id].score=n.data.score):a[n.data.id]={id:n.data.id,name:n.data.name,created:1e3*n.data.created_utc,title:n.data.title,author:n.data.author,subreddit:n.data.subreddit_name_prefixed,comments:n.data.permalink,ups:n.data.ups,score:n.data.score,domain:n.data.domain,url:n.data.url,thumb:"http"!==n.data.thumbnail.substring(0,4)?"https://via.placeholder.com/140x90/333/FFF/?text=".concat(n.data.thumbnail):n.data.thumbnail,thumbHeight:n.data.thumbnail_height,thumbWidth:n.data.thumbnail_width}})}),Object.keys(a).forEach(function(e){t[e]=a[e]}),this.setState(function(e,a){return{listings:[],posts:t}},function(){return e.getListItems()})}},{key:"getListItems",value:function(){var e=this,t=(new Date).getTime(),a=Object.values(this.state.posts).map(function(a){return s.a.createElement("li",{key:a.id},s.a.createElement("div",{className:"title"},s.a.createElement("a",{href:"https://reddit.com".concat(a.comments),target:"_blank",rel:"noopener noreferrer"},a.title)),s.a.createElement("div",{className:"details"},s.a.createElement("div",{className:"stats"},s.a.createElement("span",null,s.a.createElement("p",null,s.a.createElement("span",{className:"ups"},"ups"),": ",a.ups)),s.a.createElement("span",{className:"ages"},s.a.createElement("p",null,"age: ",Math.round((t-a.created)/36e5*100)/100)),s.a.createElement("span",{className:"avgs"},s.a.createElement("p",null,Math.round(Math.round(a.ups/(Math.round((t-a.created)/36e5*100)/100))/60*100)/100," ",s.a.createElement("span",{className:"ups"},"ups"),"/min"))),s.a.createElement("a",{href:a.url,target:"_blank",rel:"noopener noreferrer"},s.a.createElement("img",{src:a.thumb,alt:a.title}))),"all"===e.state.subreddit.substring(0,3)?s.a.createElement("div",{className:"source",style:{justifyContent:"space-between"}},s.a.createElement("small",null,a.subreddit),s.a.createElement("small",null,a.domain)):s.a.createElement("div",{className:"source",style:{justifyContent:"flex-end"}},s.a.createElement("small",null,a.domain)))});a=this.sortListItems(a),this.setState(function(e,t){return{allTitles:a,displayTitles:a}},function(){e.filterListItems()})}},{key:"sortListItems",value:function(e){return e.sort(function(e,t){return t.props.children[1].props.children[0].props.children[2].props.children.props.children[0]-e.props.children[1].props.children[0].props.children[2].props.children.props.children[0]})}},{key:"filterListItems",value:function(){var e=this,t=this.state.allTitles.filter(function(t){return t.props.children[1].props.children[0].props.children[1].props.children.props.children[1]<e.state.maxAge});this.setState(function(e,a){return{displayTitles:t}})}},{key:"handleSubmit",value:function(e){var t=this;if(e.preventDefault(),"submit"===e.type){var a=document.getElementById("sub-value").value;a.length>0&&(clearInterval(this.state.pollRef),this.setState(function(e,t){return{subreddit:a,listings:[],posts:[],allTitles:[],displayTitles:"loading..."}},function(){t.reqData(),t.setState(function(e,a){return{pollRef:setInterval(function(){return t.reqData()},t.state.interval)}})}))}else if("input"===e.type){var n=+e.target.value;this.setState(function(e,t){return{maxAge:n}},function(){return t.filterListItems()})}}},{key:"render",value:function(){return s.a.createElement(s.a.Fragment,null,s.a.createElement("ul",null,s.a.createElement("li",null,s.a.createElement("div",{id:"control-header"},s.a.createElement("span",null,s.a.createElement("span",{className:"ups"},"ups")," rate ",s.a.createElement("span",{style:{color:"red"}},"live")),s.a.createElement("span",{id:"live-indicator",role:"img","aria-label":"live indicator"},"\ud83d\udd34")),s.a.createElement("div",{id:"controls"},s.a.createElement("div",{id:"sub-controls"},s.a.createElement("form",{onSubmit:this.handleSubmit},s.a.createElement("label",{style:{flexShrink:"0"},htmlFor:"sub-value"},s.a.createElement("span",{id:"full-sub-label"},"subreddit: r/"),s.a.createElement("span",{id:"partial-sub-label"},"r/")),s.a.createElement("input",{style:{flexGrow:"0"},type:"text",id:"sub-value",placeholder:this.state.subreddit}),s.a.createElement("input",{style:{flexGrow:"0"},type:"submit",id:"sub-submit",value:"submit"}))),s.a.createElement("div",{id:"age-controls"},s.a.createElement("label",{style:{flexShrink:"0"}},"max age:"),s.a.createElement("select",{id:"age-select",onInput:this.handleSubmit},s.a.createElement("option",{value:"2"},"2 hours"),s.a.createElement("option",{value:"3"},"3 hours"),s.a.createElement("option",{value:"6"},"6 hours"),s.a.createElement("option",{value:"12"},"12 hours"),s.a.createElement("option",{value:"24"},"24 hours"))))),this.state.displayTitles))}}]),t}(n.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(s.a.createElement(p,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[10,2,1]]]);
//# sourceMappingURL=main.b6ff52ef.chunk.js.map