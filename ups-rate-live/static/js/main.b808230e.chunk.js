(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{10:function(e,t,a){e.exports=a(20)},15:function(e,t,a){},17:function(e,t,a){},20:function(e,t,a){"use strict";a.r(t);var n=a(1),s=a.n(n),r=a(8),i=a.n(r),l=(a(15),a(2)),c=a(3),o=a(6),u=a(4),d=a(5),h=(a(17),a(9)),m=a(0),p=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(o.a)(this,Object(u.a)(t).call(this))).state={fetchLimit:2,fetchCount:0,maxAge:2,subreddit:"politics",listings:[],posts:[],allListItems:[],componentDisplay:"loading...",pollInterval:6e4,pollRef:null},e.componentDidMount=e.componentDidMount.bind(Object(m.a)(Object(m.a)(e))),e.displayErrorMsg=e.displayErrorMsg.bind(Object(m.a)(Object(m.a)(e))),e.reqData=e.reqData.bind(Object(m.a)(Object(m.a)(e))),e.validateUrl=e.validateUrl.bind(Object(m.a)(Object(m.a)(e))),e.createReq=e.createReq.bind(Object(m.a)(Object(m.a)(e))),e.sendReq=e.sendReq.bind(Object(m.a)(Object(m.a)(e))),e.evaluateRes=e.evaluateRes.bind(Object(m.a)(Object(m.a)(e))),e.handleAccepted=e.handleAccepted.bind(Object(m.a)(Object(m.a)(e))),e.handleRejected=e.handleRejected.bind(Object(m.a)(Object(m.a)(e))),e.handleReqException=e.handleReqException.bind(Object(m.a)(Object(m.a)(e))),e.assignResData=e.assignResData.bind(Object(m.a)(Object(m.a)(e))),e.updateReqSettings=e.updateReqSettings.bind(Object(m.a)(Object(m.a)(e))),e.evaluateReqSettings=e.evaluateReqSettings.bind(Object(m.a)(Object(m.a)(e))),e.getThumbProp=e.getThumbProp.bind(Object(m.a)(Object(m.a)(e))),e.getCreatedProp=e.getCreatedProp.bind(Object(m.a)(Object(m.a)(e))),e.parseData=e.parseData.bind(Object(m.a)(Object(m.a)(e))),e.getPostAge=e.getPostAge.bind(Object(m.a)(Object(m.a)(e))),e.getPostUpsAvg=e.getPostUpsAvg.bind(Object(m.a)(Object(m.a)(e))),e.getPostTitleElement=e.getPostTitleElement.bind(Object(m.a)(Object(m.a)(e))),e.getPostDetailsElement=e.getPostDetailsElement.bind(Object(m.a)(Object(m.a)(e))),e.getPostSourceElement=e.getPostSourceElement.bind(Object(m.a)(Object(m.a)(e))),e.getPostElement=e.getPostElement.bind(Object(m.a)(Object(m.a)(e))),e.getListItems=e.getListItems.bind(Object(m.a)(Object(m.a)(e))),e.sortListItems=e.sortListItems.bind(Object(m.a)(Object(m.a)(e))),e.filterListItems=e.filterListItems.bind(Object(m.a)(Object(m.a)(e))),e.handleSubmit=e.handleSubmit.bind(Object(m.a)(Object(m.a)(e))),e}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.reqData(),this.setState(function(t,a){return{pollRef:setInterval(function(){return e.reqData()},e.state.pollInterval)}})}},{key:"displayErrorMsg",value:function(e){this.setState(function(t,a){return{componentDisplay:e}})}},{key:"reqData",value:function(e){this.sendReq(this.createReq(e))}},{key:"validateUrl",value:function(e){return e||"https://old.reddit.com/r/".concat(this.state.subreddit,".json?limit=100")}},{key:"createReq",value:function(e){return new Request(this.validateUrl(e))}},{key:"handleAccepted",value:function(e){return e.ok?e.json():(clearInterval(this.state.pollRef),console.log("network error:\n",e),this.displayErrorMsg('error: response from "'.concat(e.url,'" was "').concat(e.status,": ").concat(e.statusText,'".')),null)}},{key:"handleRejected",value:function(e){return clearInterval(this.state.pollRef),console.log("fetch rejected:\n",e),this.displayErrorMsg("error: request rejected, invalid search url or request blocked by browser. check search url, browser settings, or console for more details."),null}},{key:"handleReqException",value:function(e){clearInterval(this.state.pollRef),console.log("fetch exception:\n",e),this.displayErrorMsg("error: fetch exception, check console for details.")}},{key:"sendReq",value:function(e){var t=this;fetch(e).then(function(e){return t.handleAccepted(e)},function(e){return t.handleRejected(e)}).then(function(e){return t.evaluateRes(e)}).catch(function(e){return t.handleReqException(e)})}},{key:"evaluateRes",value:function(e){console.log("server response:\n",e),e?this.assignResData(e):null!==e&&this.displayErrorMsg("error: evaluateRes passed non-null, falsy argument. check console for more details.")}},{key:"assignResData",value:function(e){var t=this;this.setState(function(t,a){return{listings:Object(h.a)(t.listings).concat([e])}},function(){return t.updateReqSettings()})}},{key:"updateReqSettings",value:function(){var e=this;this.setState(function(e,t){return{fetchCount:e.fetchCount+1}},function(){return e.evaluateReqSettings()})}},{key:"evaluateReqSettings",value:function(){var e=this;this.state.fetchCount<this.state.fetchLimit&&this.state.listings[+this.state.fetchCount-1].data.after?this.reqData("https://old.reddit.com/r/".concat(this.state.subreddit,".json?limit=100&after=").concat(this.state.listings[this.state.fetchCount-1].data.after)):this.setState(function(e,t){return{fetchCount:0}},function(){return e.parseData()})}},{key:"getThumbProp",value:function(e){return"http"!==e.substring(0,4)?"https://via.placeholder.com/140x90/333/FFF/?text=".concat(e):e}},{key:"getCreatedProp",value:function(e){return 1e3*e}},{key:"parseData",value:function(){var e=this,t=this.state.posts,a=[];Object.values(this.state.listings).forEach(function(n){Object.values(n.data.children).forEach(function(n){Object.keys(e.state.posts).includes(n.data.id)?t[n.data.id].ups!==n.data.ups&&(t[n.data.id].ups=n.data.ups,t[n.data.id].score=n.data.score):a[n.data.id]={id:n.data.id,name:n.data.name,created:e.getCreatedProp(n.data.created_utc),title:n.data.title,author:n.data.author,subreddit:n.data.subreddit_name_prefixed,comments:n.data.permalink,ups:n.data.ups,score:n.data.score,domain:n.data.domain,url:n.data.url,thumb:e.getThumbProp(n.data.thumbnail),thumbHeight:n.data.thumbnail_height,thumbWidth:n.data.thumbnail_width}})}),Object.keys(a).forEach(function(e){t[e]=a[e]}),this.setState(function(e,a){return{listings:[],posts:t}},function(){return e.getListItems()})}},{key:"getPostAge",value:function(e,t){return Math.round((t-e)/36e5*100)/100}},{key:"getPostUpsAvg",value:function(e,t,a){return Math.round(Math.round(a/(Math.round((t-e)/36e5*100)/100))/60*100)/100}},{key:"getPostTitleElement",value:function(e,t){return s.a.createElement("div",{className:"title"},s.a.createElement("a",{href:"https://reddit.com".concat(e),target:"_blank",rel:"noopener noreferrer"},t))}},{key:"getPostDetailsElement",value:function(e,t,a,n,r,i){return s.a.createElement("div",{className:"details"},s.a.createElement("div",{className:"stats"},s.a.createElement("span",null,s.a.createElement("p",null,s.a.createElement("span",{className:"ups"},"ups"),": ",e)),s.a.createElement("span",{className:"ages"},s.a.createElement("p",null,"age: ",this.getPostAge(t,a))),s.a.createElement("span",{className:"avgs"},s.a.createElement("p",null,this.getPostUpsAvg(t,a,e)," ",s.a.createElement("span",{className:"ups"},"ups"),"/min"))),s.a.createElement("a",{href:n,target:"_blank",rel:"noopener noreferrer"},s.a.createElement("img",{src:r,alt:i})))}},{key:"getPostSourceElement",value:function(e,t){return"all"===this.state.subreddit.substring(0,3)?s.a.createElement("div",{className:"source",style:{justifyContent:"space-between"}},s.a.createElement("small",null,e),s.a.createElement("small",null,t)):s.a.createElement("div",{className:"source",style:{justifyContent:"flex-end"}},s.a.createElement("small",null,t))}},{key:"getPostElement",value:function(e,t){return s.a.createElement("li",{key:e.id},this.getPostTitleElement(e.comments,e.title),this.getPostDetailsElement(e.ups,e.created,t,e.url,e.thumb,e.title),this.getPostSourceElement(e.subreddit,e.domain))}},{key:"getListItems",value:function(){var e=this,t=(new Date).getTime(),a=Object.values(this.state.posts).map(function(a){return e.getPostElement(a,t)});a=this.sortListItems(a),this.setState(function(e,t){return{allListItems:a}},function(){return e.filterListItems()})}},{key:"sortListItems",value:function(e){return e.sort(function(e,t){return t.props.children[1].props.children[0].props.children[2].props.children.props.children[0]-e.props.children[1].props.children[0].props.children[2].props.children.props.children[0]})}},{key:"filterListItems",value:function(){var e=this,t=this.state.allListItems.filter(function(t){return t.props.children[1].props.children[0].props.children[1].props.children.props.children[1]<e.state.maxAge});0===t.length&&(t="0/".concat(this.state.allListItems.length," posts with age under ").concat(this.state.maxAge," hours.\ntry increasing max age.\n")),this.setState(function(e,a){return{componentDisplay:t}})}},{key:"handleSubmit",value:function(e){var t=this;if(e.preventDefault(),"submit"===e.type){var a=document.getElementById("sub-value".concat(this.props.listNum)).value;a.length>0&&(clearInterval(this.state.pollRef),this.setState(function(e,t){return{subreddit:a,listings:[],posts:[],allListItems:[],componentDisplay:"loading..."}},function(){t.reqData(),t.setState(function(e,a){return{pollRef:setInterval(function(){return t.reqData()},t.state.pollInterval)}})}))}else if("input"===e.type){var n=+e.target.value;this.setState(function(e,t){return{maxAge:n}},function(){return t.filterListItems()})}}},{key:"render",value:function(){return s.a.createElement(s.a.Fragment,null,s.a.createElement("ul",null,s.a.createElement("li",null,s.a.createElement("div",{id:"control-header"},s.a.createElement("span",null,s.a.createElement("span",{className:"ups"},"ups")," rate ",s.a.createElement("span",{style:{color:"red"}},"live")),s.a.createElement("span",{id:"live-indicator",role:"img","aria-label":"live indicator"},"\ud83d\udd34")),s.a.createElement("div",{id:"controls"},s.a.createElement("div",{id:"sub-controls"},s.a.createElement("form",{onSubmit:this.handleSubmit},s.a.createElement("label",{style:{flexShrink:"0"},htmlFor:"sub-value".concat(this.props.listNum)},s.a.createElement("span",{id:"full-sub-label"},"subreddit: r/"),s.a.createElement("span",{id:"partial-sub-label"},"r/")),s.a.createElement("input",{style:{flexGrow:"0"},type:"text",id:"sub-value".concat(this.props.listNum),className:"sub-value",placeholder:this.state.subreddit}),s.a.createElement("input",{style:{flexGrow:"0"},type:"submit",id:"sub-submit",value:"submit"}))),s.a.createElement("div",{id:"age-controls"},s.a.createElement("label",{style:{flexShrink:"0"}},"max age:"),s.a.createElement("select",{id:"age-select",onInput:this.handleSubmit},s.a.createElement("option",{value:"2"},"2 hours"),s.a.createElement("option",{value:"3"},"3 hours"),s.a.createElement("option",{value:"6"},"6 hours"),s.a.createElement("option",{value:"12"},"12 hours"),s.a.createElement("option",{value:"24"},"24 hours"))))),this.state.componentDisplay))}}]),t}(n.Component),b=function(e){function t(){return Object(l.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return s.a.createElement(p,{listNum:1})}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(s.a.createElement(b,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[10,2,1]]]);
//# sourceMappingURL=main.b808230e.chunk.js.map